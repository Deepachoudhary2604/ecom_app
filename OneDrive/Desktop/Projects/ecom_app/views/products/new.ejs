<%- layout('layouts/boilerplate') %>
<%- include('../partials/navbar') %>
<%- include('../partials/flash') %>

<div class="container mt-5 mb-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg" style="border-radius: 15px; overflow: hidden; border: none;">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; text-align: center; color: white;">
                    <div style="font-size: 3rem; margin-bottom: 15px;">➕</div>
                    <h2 class="card-title mb-2" style="color: white;">Add New Product</h2>
                    <p style="margin: 0; opacity: 0.9;">Fill in the details below to add a new product to your catalog</p>
                </div>

                <div class="card-body p-5">
                    <form action="/products" method="POST" class="needs-validation" novalidate>
                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <label for="name" class="form-label fw-bold">
                                    <i class="bi bi-tag"></i> Product Name
                                </label>
                                <input type="text" 
                                       class="form-control form-control-lg" 
                                       placeholder="e.g., Wireless Headphones" 
                                       id="name" 
                                       name="name"
                                       style="border: 2px solid #e0e0e0; border-radius: 8px;"
                                       required>
                                <div class="valid-feedback">Looks good!</div>
                                <div class="invalid-feedback">Please enter a product name.</div>
                            </div>

                            <div class="col-md-6 mb-4">
                                <label for="price" class="form-label fw-bold">
                                    <i class="bi bi-currency-rupee"></i> Price
                                </label>
                                <input type="number" 
                                       class="form-control form-control-lg" 
                                       placeholder="0.00" 
                                       id="price" 
                                       name="price" 
                                       min="1"
                                       step="0.01"
                                       style="border: 2px solid #e0e0e0; border-radius: 8px;"
                                       required>
                                <div class="valid-feedback">Looks good!</div>
                                <div class="invalid-feedback">Please enter a valid price.</div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="img" class="form-label fw-bold">
                                <i class="bi bi-image"></i> Image URL
                            </label>
                            <input type="url" 
                                   class="form-control form-control-lg" 
                                   placeholder="https://example.com/image.jpg" 
                                   id="img" 
                                   name="img"
                                   style="border: 2px solid #e0e0e0; border-radius: 8px;"
                                   required>
                            <small class="text-muted d-block mt-2">Include complete URL (http/https)</small>
                            <div id="imagePreview" class="mt-3"></div>
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please provide a valid image URL.</div>
                        </div>

                        <div class="mb-4">
                            <label for="desc" class="form-label fw-bold">
                                <i class="bi bi-file-text"></i> Description
                            </label>
                            <textarea class="form-control form-control-lg" 
                                      placeholder="Describe your product in detail..." 
                                      id="desc" 
                                      name="desc" 
                                      rows="5"
                                      style="border: 2px solid #e0e0e0; border-radius: 8px;"
                                      required></textarea>
                            <div class="valid-feedback">Looks good!</div>
                            <div class="invalid-feedback">Please enter a description.</div>
                        </div>

                        <!-- Submit Buttons -->
                        <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
                            <button type="submit" class="btn btn-success btn-lg" style="background: linear-gradient(135deg, #28a745, #20c997); border: none; font-weight: 600; padding: 12px 40px;">
                                <i class="bi bi-check-circle"></i> Add Product
                            </button>
                            <a href="/products" class="btn btn-secondary btn-lg" style="font-weight: 600; padding: 12px 40px;">
                                <i class="bi bi-x-circle"></i> Cancel
                            </a>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Info Card -->
            <div class="card mt-4 shadow-sm" style="border-radius: 12px; border: 2px solid #667eea; background: linear-gradient(135deg, #f0f4ff, #e8eeff);">
                <div class="card-body">
                    <h6 class="card-title mb-3" style="color: #667eea;">
                        <i class="bi bi-lightbulb"></i> Tips for Adding Products
                    </h6>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li class="mb-2">✓ Use clear, descriptive product names</li>
                        <li class="mb-2">✓ Include high-quality product images</li>
                        <li class="mb-2">✓ Write detailed descriptions highlighting key features</li>
                        <li class="mb-2">✓ Set competitive and attractive prices</li>
                        <li>✓ Ensure image URLs are accessible and load quickly</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .form-control, .form-control-lg {
        transition: all 0.3s;
    }

    .form-control:focus, .form-control-lg:focus {
        border-color: #667eea !important;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25) !important;
    }

    .btn {
        transition: all 0.3s;
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .form-label {
        color: #333;
    }
</style>

<!-- Bootstrap Form Validation Script -->
<script>
    (function () {
        'use strict';
        const forms = document.querySelectorAll('.needs-validation');
        Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                form.classList.add('was-validated');
            }, false);
        });
    })();

    // Image preview
    document.getElementById('img').addEventListener('change', function() {
        const url = this.value;
        const preview = document.getElementById('imagePreview');
        if (url) {
            preview.innerHTML = `<img src="${url}" style="max-width: 100%; max-height: 200px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" onerror="this.parentElement.innerHTML='<div class=\"alert alert-warning\">Image could not be loaded</div>'">`;
        }
    });
</script>
